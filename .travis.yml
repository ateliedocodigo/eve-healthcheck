language: python
services: mongodb
matrix:
  include:
    - python: 2.7
      env:
        - TOXENV=py27
    - python: 3.5
      env:
        - TOXENV=py3
    - python: 3.6
      env:
        - TOXENV=py3
    - python: 3.7 # https://docs.travis-ci.com/user/languages/python/#running-python-tests-on-multiple-operating-systems
      dist: xenial # required for Python >= 3.7
      env:
        - TOXENV=py3
    - python: 3.7
      dist: xenial
      env:
        - TOXENV=coveralls
before_install:
  - pip install --upgrade pip
install:
  - pip install tox
script:
  - tox
deploy:
  provider: pypi
#  server: https://test.pypi.org/legacy/
  user: luiscoms
  password:
    # generated with travis encrypt
    secure: "emWzE3LiC/KLgCBzcavEy55yo42a08A8s/2dhuZ8m7wtI4cCIl8bFGsxRthNxXvki3riqyZF9tzjgTCSUR9B6tuQxuFIUsxwJNvwNzk7GFx7xmmDOik4x5VwMMF+phzpe00QmvUKXq63qP9w4YiEKMor9fCbak9deHldnduFe53AZBvJJMfXhWPvBvqOCYoUHsPZYKkkR5k69wIyhiVPjnDRX4/+c3o9DYLdE6R+JO4l5xuHtWwySssdSpCjqlqs0WIVuKMuFs+pRrun312gx5saJQnmv13uWAZiwFNjlAWHI89nMsK09qMn3BiMbfo0nqdkjaIQnaKGuUwHlDiZ9Kdv0KEddCAqW96X2dZNDizWV/JGelqj6u8XufX2maI4t0EeYUMLu6tvMHkm5hMGj/kqLlE+LufetNXS/F/QTvmRSz2QjJH3i7IAKRHAsA1S3rOuCgDz6ljyyi8SDm3EWz37Gcnb4iRDJR0GekUmskuKLnMauUS6XmWzMpilPUt9liX8hrrp0ehYtyupEOC7O9+A6z6j/mB5D9hxg9CfTaOA9XCqjjLNAci9Cf6InH4apnyo82pP6ZCU76CII36rRv4uxwjJBCiccacpgA5GhIIh2RiTxfIuMuEAF7S+g4mKTosSxJekz4xjuObNECzpoHe2o6LQDSXa1MWLXUz+fBo="
  skip_cleanup: true
  on:
    tags: true
    condition: $TOXENV = coveralls
